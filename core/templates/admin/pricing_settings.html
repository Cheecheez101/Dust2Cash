{% extends 'base.html' %}
{% block title %}Pricing Settings — Dust2Cash{% endblock %}
{% block content %}
<section class="page-info-section page-info-admin">
  <div class="container">
    <div class="d-flex flex-column flex-md-row align-items-md-center justify-content-between gap-3">
      <div>
        <p class="eyebrow text-muted mb-2">Trading parameters</p>
        <h2 class="mb-1">Pricing Settings</h2>
        <div class="site-beradcamb">
          <a href="/">Home</a>
          <span><i class="fa fa-angle-right"></i> Admin</span>
          <span><i class="fa fa-angle-right"></i> Pricing</span>
        </div>
      </div>
      <a class="btn btn-outline-light" href="{% url 'admin_dashboard' %}">
        <i class="fa fa-arrow-left me-2"></i>Back to dashboard
      </a>
    </div>
  </div>
</section>
<section class="admin-form">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-md-7">
        <div class="card shadow-sm border-0">
          <div class="card-body p-4">
            <h5 class="mb-3">Set Exchange Rate & Fee</h5>
            <p class="text-muted small mb-4">
              These values feed the client dashboard, pricing tables, and default transaction calculations.
            </p>
            <form method="post">
              {% csrf_token %}
              <div class="mb-3">
                <label class="form-label">Exchange Rate (KSH per USDT)</label>
                {{ form.exchange_rate }}
                {% if form.exchange_rate.errors %}
                  <div class="text-danger small">{{ form.exchange_rate.errors.0 }}</div>
                {% endif %}
              </div>
              <div class="mb-3">
                <label class="form-label">Transaction Fee (%)</label>
                {{ form.transaction_fee_percent }}
                {% if form.transaction_fee_percent.errors %}
                  <div class="text-danger small">{{ form.transaction_fee_percent.errors.0 }}</div>
                {% endif %}
              </div>
              <div class="alert alert-info small">
                <strong>Heads up:</strong> fee is applied as <code>amount × exchange_rate × fee%</code> when clients create transactions.
              </div>
              <div class="d-grid gap-2">
                <button class="btn btn-gradient" type="submit">Save Pricing</button>
                <a class="btn btn-outline-secondary" href="{% url 'admin_dashboard' %}">Cancel</a>
              </div>
            </form>
            <hr>
            <p class="small text-muted mb-0">
              Last updated {{ pricing.updated_at|date:"M d, Y H:i" }}{% if pricing.updated_by %} by {{ pricing.updated_by.get_full_name|default:pricing.updated_by.username }}{% endif %}.
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
{% endblock %}

